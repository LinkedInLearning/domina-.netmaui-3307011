<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="WisdomPetMedicine.Views.MapPage"
             xmlns:maps="http://schemas.microsoft.com/dotnet/2021/maui/maps"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:converters="clr-namespace:WisdomPetMedicine.Converters"
             Title="{Binding Clients.Count, StringFormat='Clientes ({0} en total)'}">
    <ContentPage.Resources>
        <converters:ClientToLocationConverter x:Key="ClientToLocationConverter" />
    </ContentPage.Resources>
    
    <Grid>
        <maps:Map ItemsSource="{Binding Clients}" x:Name="map">
            <maps:Map.ItemTemplate>
                <DataTemplate>
                    <maps:Pin Location="{Binding ., Converter={StaticResource ClientToLocationConverter}}"
                              Label="{Binding Name}" />
                </DataTemplate>
            </maps:Map.ItemTemplate>
            <maps:Map.Behaviors>
                <toolkit:EventToCommandBehavior
                    EventName="Loaded"
                    Command="{Binding LoadCommand}"
                    CommandParameter="{Binding Source={x:Reference map}}" />
            </maps:Map.Behaviors>
        </maps:Map>
    </Grid>
</ContentPage>